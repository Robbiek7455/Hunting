<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Davisboro Hunt Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- App styles -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="page-header">
      <h1>Davisboro Hunt Console</h1>
      <p>Weather ‚Ä¢ rut ‚Ä¢ moon ‚Ä¢ wind ‚Ä¢ stand matching ‚Ä¢ interactive map</p>
      <nav class="top-nav">
        <a href="#today">Today</a>
        <a href="#live">Live Odds</a>
        <a href="#map">Map &amp; Waypoints</a>
        <a href="#planner">7-Day Plan</a>
      </nav>
    </header>

    <!-- TODAY AT A GLANCE -->
    <section id="today" class="card card-today">
      <h2>Today at a Glance</h2>
      <p class="lead">
        Quick read on today‚Äôs whitetail setup for your Davisboro property: rut window, weather, wind, and moon ‚Äì all rolled into a hunt score.
      </p>

      <div class="today-grid">
        <div class="today-card">
          <div class="today-label">Rut</div>
          <div id="today-rut-main" class="today-value">‚Äì</div>
          <div id="today-rut-sub" class="today-sub">GA rut model</div>
        </div>

        <div class="today-card">
          <div class="today-label">Weather</div>
          <div id="today-weather-main" class="today-value">‚Äì</div>
          <div id="today-weather-sub" class="today-sub">Hi / Lo, rain</div>
        </div>

        <div class="today-card">
          <div class="today-label">Wind</div>
          <div id="today-wind-main" class="today-value">‚Äì</div>
          <div id="today-wind-sub" class="today-sub">Dominant daily wind</div>
        </div>

        <div class="today-card">
          <div class="today-label">Moon</div>
          <div id="today-moon-main" class="today-value">‚Äì</div>
          <div id="today-moon-sub" class="today-sub">Phase &amp; brightness</div>
        </div>
      </div>

      <div class="today-badge-row">
        <span id="today-score-pill" class="pill">‚Äì</span>
        <span id="today-comment" class="today-comment">
          Live score uses rut + weather at your hunt center.
        </span>
      </div>
    </section>

    <!-- LIVE ODDS + MAP -->
    <section id="live" class="card">
      <h2>Live Odds (Single Sit) &amp; Hunt Map</h2>
      <p class="lead">
        Pick a date, time, and setup. The console pulls live weather, rut phase, and moon and returns a 0‚Äì100 deer movement score.
      </p>

      <div class="two-col">
        <!-- Left: live odds form -->
        <form id="live-form">
          <div class="field">
            <label for="live-date">Hunt date</label>
            <input type="date" id="live-date" required />
          </div>

          <div class="field">
            <span class="label">Time of day</span>
            <div class="chip-row">
              <label><input type="radio" name="live-time" value="morning" checked />Morning</label>
              <label><input type="radio" name="live-time" value="midday" />Mid-day</label>
              <label><input type="radio" name="live-time" value="evening" />Evening</label>
              <label><input type="radio" name="live-time" value="allday" />All-day</label>
            </div>
          </div>

          <div class="field">
            <span class="label">Terrain focus</span>
            <div class="chip-row">
              <label><input type="radio" name="live-terrain" value="pines" checked />Pines / clear-cut</label>
              <label><input type="radio" name="live-terrain" value="hardwoods" />Hardwoods</label>
              <label><input type="radio" name="live-terrain" value="ag" />Ag / edges</label>
              <label><input type="radio" name="live-terrain" value="mixed" />Mixed</label>
            </div>
          </div>

          <div class="field">
            <span class="label">Hunting pressure</span>
            <div class="chip-row">
              <label><input type="radio" name="live-pressure" value="low" checked />Low</label>
              <label><input type="radio" name="live-pressure" value="medium" />Medium</label>
              <label><input type="radio" name="live-pressure" value="high" />High</label>
            </div>
          </div>

          <div class="field two">
            <div>
              <label for="live-lat">Latitude</label>
              <input type="number" step="0.000001" id="live-lat" placeholder="32.9790" />
            </div>
            <div>
              <label for="live-lon">Longitude</label>
              <input type="number" step="0.000001" id="live-lon" placeholder="-82.6079" />
            </div>
          </div>

          <div class="button-row">
            <button type="button" class="secondary small" id="btn-my-location">üìç Use my location</button>
            <button type="submit" id="btn-live-run">‚ö° Get live odds</button>
          </div>
          <p class="hint">
            Leave lat / lon empty to default to your Davisboro property center.
          </p>
        </form>

        <!-- Right: map -->
        <div class="map-panel">
          <div class="map-header">
            <div>
              <strong>Hunt map</strong>
              <p>
                Street, terrain, and satellite from MapTiler. Orange marker = hunt center. Turn on ‚ÄúAdd waypoint‚Äù to mark stands, blinds, feeders, and trail cams.
              </p>
            </div>
            <button type="button" class="secondary small" id="btn-add-waypoint">
              ‚ûï Add waypoint mode
            </button>
          </div>
          <div id="map" class="map"></div>
          <div class="map-legend" id="map-legend"></div>
        </div>
      </div>

      <!-- Live odds output -->
      <div id="live-results" class="results">
        <div class="score-row">
          <div class="score-badge" id="score-badge">Score ‚Äì</div>
          <div class="score-bar-outer">
            <div class="score-bar-inner" id="score-bar"></div>
          </div>
          <div class="score-label" id="score-label">Waiting for a run‚Ä¶</div>
        </div>

        <div class="factor-grid" id="factor-grid"></div>
        <div class="analysis-note" id="analysis-note"></div>
      </div>
    </section>

    <!-- WAYPOINTS -->
    <section id="map-waypoints" class="card">
      <h2 id="map">Waypoints &amp; Stand Details</h2>
      <p class="lead">
        Save stands, blinds, feeders, and trail cams with best winds and notes. Data is stored in this browser only.
      </p>

      <form id="waypoint-form">
        <div class="field two">
          <div>
            <label for="wp-name">Name</label>
            <input id="wp-name" type="text" placeholder="North ladder stand" />
          </div>
          <div>
            <label for="wp-type">Type</label>
            <select id="wp-type">
              <option>Stand</option>
              <option>Ground Blind</option>
              <option>Feeder</option>
              <option>Trail Cam</option>
              <option>Other</option>
            </select>
          </div>
        </div>

        <div class="field two">
          <div>
            <label for="wp-best-wind">Best wind</label>
            <select id="wp-best-wind">
              <option value="">Any / unknown</option>
              <option value="N">N</option>
              <option value="NE">NE</option>
              <option value="E">E</option>
              <option value="SE">SE</option>
              <option value="S">S</option>
              <option value="SW">SW</option>
              <option value="W">W</option>
              <option value="NW">NW</option>
            </select>
          </div>
          <div>
            <label for="wp-terrain">Terrain tag</label>
            <select id="wp-terrain">
              <option value="">None</option>
              <option value="pines">Pines / clear-cut</option>
              <option value="hardwoods">Hardwoods</option>
              <option value="ag">Ag / fields / plots</option>
              <option value="mixed">Mixed</option>
            </select>
          </div>
        </div>

        <div class="field two">
          <div>
            <label for="wp-lat">Latitude</label>
            <input id="wp-lat" type="number" step="0.000001" placeholder="click map to fill" />
          </div>
          <div>
            <label for="wp-lon">Longitude</label>
            <input id="wp-lon" type="number" step="0.000001" placeholder="click map to fill" />
          </div>
        </div>

        <div class="field">
          <label for="wp-notes">Notes</label>
          <textarea id="wp-notes" placeholder="Best with north wind, enter from south road, heavy acorn flat below."></textarea>
        </div>

        <div class="button-row">
          <button type="submit" id="wp-submit">üíæ Save waypoint</button>
          <button type="button" class="secondary small" id="wp-use-center">‚¨á Use hunt center</button>
          <button type="button" class="danger small" id="wp-clear-all">üóë Clear ALL (this device)</button>
        </div>
        <p class="hint">
          Tap ‚ÄúAdd waypoint mode‚Äù, click the map, then refine details here and save.
        </p>
      </form>

      <div class="table-scroll mt-compact">
        <table>
          <thead>
            <tr>
              <th>Name / type</th>
              <th>Coords</th>
              <th>Setup (terrain + wind)</th>
              <th>Wind match (plan day)</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="waypoint-list"></tbody>
        </table>
      </div>
    </section>

    <!-- 7-DAY PLANNER + STAND RECS -->
    <section id="planner" class="card">
      <h2>7-Day Deer Activity Planner</h2>
      <p class="lead">
        Ranks the next 7 days (0‚Äì100) using rut phase, temperature, wind, rain, sunrise/sunset, and moon. Use it to pick your best sits in advance.
      </p>

      <form id="planner-form">
        <div class="field two">
          <div>
            <label for="plan-start">Start date</label>
            <input type="date" id="plan-start" required />
          </div>
          <div>
            <label for="plan-terrain">Terrain focus</label>
            <select id="plan-terrain">
              <option value="pines">Pines / clear-cut</option>
              <option value="hardwoods">Hardwoods</option>
              <option value="ag">Ag / edges</option>
              <option value="mixed" selected>Mixed</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label for="plan-pressure">Hunting pressure</label>
          <select id="plan-pressure">
            <option value="low">Low</option>
            <option value="medium" selected>Medium</option>
            <option value="high">High</option>
          </select>
        </div>

        <div class="field two">
          <div>
            <label for="plan-lat">Latitude</label>
            <input id="plan-lat" type="number" step="0.000001" placeholder="auto from hunt center" />
          </div>
          <div>
            <label for="plan-lon">Longitude</label>
            <input id="plan-lon" type="number" step="0.000001" placeholder="auto from hunt center" />
          </div>
        </div>

        <div class="button-row">
          <button type="submit" id="btn-plan-run">üìÜ Generate 7-day plan</button>
        </div>
      </form>

      <div class="table-scroll mt-compact">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Rut phase</th>
              <th>Hi / Lo (¬∞F)</th>
              <th>Wind</th>
              <th>Weather / Sun / Moon</th>
              <th>Focus</th>
              <th>Score</th>
            </tr>
          </thead>
          <tbody id="planner-rows"></tbody>
        </table>
      </div>

      <div id="stand-recos" class="stand-recos">
        <!-- filled by JS with stand recommendations based on plan wind -->
      </div>
    </section>

    <section class="card">
      <p class="hint">
        Weather by Open-Meteo. Moon phase by ViewBits. This tool is a planning aid ‚Äì always obey Georgia regulations and use your own judgment in the woods.
      </p>
    </section>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-o9N1j7kGStpG32sV1J5x7M7Wv5p3p5lH0kG2Z7r3yU="
    crossorigin=""
  ></script>

  <!-- App logic -->
  <script src="app.js"></script>
</body>
</html>
